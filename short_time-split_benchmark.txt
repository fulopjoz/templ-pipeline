(.templ) ubuntu@drugex-vm:~/mcs/templ_pipeline$ templ benchmark time-split --test-only --max-pdbs 20
INFO: Welcome to TEMPL! For getting started help: templ --help getting-started
INFO: Optimized config (balanced) → n_workers=22, internal_workers=1, CPUs=22, RAM=50.4GB
INFO: Optimized config (balanced) → n_workers=22, internal_workers=1, CPUs=22, RAM=50.4GB
INFO: Hardware optimization: auto profile
INFO: Workers: 11, Strategy: memory-bound
INFO: Starting Timesplit benchmark for splits: test
INFO: Using 11 workers, 200 conformers
INFO: Workspace directory: benchmark_workspace_time-split_20250704_115049/
INFO: Error tracking enabled
INFO: TEMPL pipeline initialized with 0.1GB memory usage
INFO: Shared cache not available, loading individually
INFO: Loading molecules from processed_ligands_new.sdf.gz...
INFO: Error tracking enabled
INFO: TEMPL pipeline initialized with 0.1GB memory usage
INFO: Shared cache not available, loading individually
INFO: Loading molecules from processed_ligands_new.sdf.gz...
INFO: Error tracking enabled
INFO: TEMPL pipeline initialized with 0.1GB memory usage
INFO: Shared cache not available, loading individually
INFO: Loading molecules from processed_ligands_new.sdf.gz...
INFO: Error tracking enabled
INFO: TEMPL pipeline initialized with 0.1GB memory usage
INFO: Shared cache not available, loading individually
INFO: Loading molecules from processed_ligands_new.sdf.gz...
INFO: Error tracking enabled
INFO: TEMPL pipeline initialized with 0.1GB memory usage
INFO: Shared cache not available, loading individually
INFO: Loading molecules from processed_ligands_new.sdf.gz...
INFO: Error tracking enabled
INFO: TEMPL pipeline initialized with 0.1GB memory usage
INFO: Shared cache not available, loading individually
INFO: Loading molecules from processed_ligands_new.sdf.gz...
INFO: Error tracking enabled
INFO: TEMPL pipeline initialized with 0.1GB memory usage
INFO: Error tracking enabled
INFO: Shared cache not available, loading individually
INFO: Loading molecules from processed_ligands_new.sdf.gz...
INFO: TEMPL pipeline initialized with 0.1GB memory usage
INFO: Shared cache not available, loading individually
INFO: Loading molecules from processed_ligands_new.sdf.gz...
INFO: Error tracking enabled
INFO: TEMPL pipeline initialized with 0.1GB memory usage
INFO: Shared cache not available, loading individually
INFO: Loading molecules from processed_ligands_new.sdf.gz...
INFO: Error tracking enabled
INFO: TEMPL pipeline initialized with 0.1GB memory usage
INFO: Shared cache not available, loading individually
INFO: Loading molecules from processed_ligands_new.sdf.gz...
INFO: Error tracking enabled
INFO: TEMPL pipeline initialized with 0.1GB memory usage
INFO: Shared cache not available, loading individually
INFO: Loading molecules from processed_ligands_new.sdf.gz...
INFO: Loaded 18902 molecules from processed_ligands_new.sdf.gz (skipped 0)
INFO: Memory used for loading: 0.4GB
INFO: Loaded 18902 molecules into cache
INFO: Loaded 18902 molecules from processed_ligands_new.sdf.gz (skipped 0)
INFO: Memory used for loading: 0.4GB
INFO: Loaded 18902 molecules into cache
INFO: Running TEMPL pipeline for 6hzb
INFO: Starting pipeline execution for 6hzb
INFO: Step 1: Generating protein embedding
INFO: Running TEMPL pipeline for 6d08
INFO: Starting pipeline execution for 6d08
INFO: Step 1: Generating protein embedding
INFO: Loaded 18902 molecules from processed_ligands_new.sdf.gz (skipped 0)
INFO: Memory used for loading: 0.4GB
INFO: Loaded 18902 molecules from processed_ligands_new.sdf.gz (skipped 0)
INFO: Memory used for loading: 0.4GB
INFO: Loaded 18902 molecules into cache
INFO: Loaded 18902 molecules from processed_ligands_new.sdf.gz (skipped 0)
INFO: Memory used for loading: 0.4GB
INFO: Loaded 18902 molecules into cache
INFO: Loaded 18902 molecules into cache
INFO: Running TEMPL pipeline for 6qqw
INFO: Starting pipeline execution for 6qqw
INFO: Step 1: Generating protein embedding
INFO: Running TEMPL pipeline for 6jsn
INFO: Starting pipeline execution for 6jsn
INFO: Step 1: Generating protein embedding
INFO: Running TEMPL pipeline for 6qrc
INFO: Starting pipeline execution for 6qrc
INFO: Step 1: Generating protein embedding
INFO: Loaded 18902 molecules from processed_ligands_new.sdf.gz (skipped 0)
INFO: Memory used for loading: 0.4GB
INFO: Loaded 18902 molecules into cache
INFO: Running TEMPL pipeline for 6jap
INFO: Starting pipeline execution for 6jap
INFO: Step 1: Generating protein embedding
INFO: Loaded 18902 molecules from processed_ligands_new.sdf.gz (skipped 0)
INFO: Memory used for loading: 0.4GB
INFO: Loaded 18902 molecules into cache
INFO: Running TEMPL pipeline for 6oxq
INFO: Starting pipeline execution for 6oxq
INFO: Step 1: Generating protein embedding
INFO: Loaded 18902 molecules from processed_ligands_new.sdf.gz (skipped 0)
INFO: Memory used for loading: 0.4GB
INFO: Loaded 18902 molecules into cache
INFO: Running TEMPL pipeline for 6np2
INFO: Starting pipeline execution for 6np2
INFO: Step 1: Generating protein embedding
INFO: Loaded 18902 molecules from processed_ligands_new.sdf.gz (skipped 0)
INFO: Memory used for loading: 0.4GB
INFO: Loaded 18902 molecules from processed_ligands_new.sdf.gz (skipped 0)
INFO: Memory used for loading: 0.4GB
INFO: Loaded 18902 molecules into cache
INFO: Loaded 18902 molecules into cache
INFO: Running TEMPL pipeline for 6uvp
INFO: Starting pipeline execution for 6uvp
INFO: Step 1: Generating protein embedding
INFO: Running TEMPL pipeline for 6oio
INFO: Starting pipeline execution for 6oio
INFO: Step 1: Generating protein embedding
INFO: Generating embedding for /home/ubuntu/mcs/templ_pipeline/data/PDBBind/PDBbind_v2020_refined/refined-set/6hzb/6hzb_protein.pdb
INFO: Generating embedding for /home/ubuntu/mcs/templ_pipeline/data/PDBBind/PDBbind_v2020_refined/refined-set/6qqw/6qqw_protein.pdb
INFO: Generating embedding for /home/ubuntu/mcs/templ_pipeline/data/PDBBind/PDBbind_v2020_other_PL/v2020-other-PL/6d08/6d08_protein.pdb
INFO: Loaded 18902 molecules from processed_ligands_new.sdf.gz (skipped 0)
INFO: Memory used for loading: 0.4GB
INFO: Loaded 18902 molecules into cache
INFO: Generating embedding for /home/ubuntu/mcs/templ_pipeline/data/PDBBind/PDBbind_v2020_refined/refined-set/6qrc/6qrc_protein.pdb
INFO: Generating embedding for /home/ubuntu/mcs/templ_pipeline/data/PDBBind/PDBbind_v2020_refined/refined-set/6jap/6jap_protein.pdb
INFO: Generating embedding for /home/ubuntu/mcs/templ_pipeline/data/PDBBind/PDBbind_v2020_other_PL/v2020-other-PL/6jsn/6jsn_protein.pdb
INFO: Generating embedding for /home/ubuntu/mcs/templ_pipeline/data/PDBBind/PDBbind_v2020_other_PL/v2020-other-PL/6oxq/6oxq_protein.pdb
INFO: Running TEMPL pipeline for 6jag
INFO: Starting pipeline execution for 6jag
INFO: Step 1: Generating protein embedding
INFO: Generating embedding for /home/ubuntu/mcs/templ_pipeline/data/PDBBind/PDBbind_v2020_other_PL/v2020-other-PL/6oio/6oio_protein.pdb
2025-07-04 11:50:56,332 - templ_pipeline.core.embedding - INFO - Loaded 18902 embeddings from /home/ubuntu/mcs/templ_pipeline/data/embeddings/protein_embeddings_base.npz
INFO: Loaded 18902 embeddings from /home/ubuntu/mcs/templ_pipeline/data/embeddings/protein_embeddings_base.npz
INFO: Using cached embedding for PDB: 6d08
INFO: Retrieved cached embedding with shape (1280,) for chain A
INFO: Step 2: Finding similar templates
INFO: Finding similar templates
2025-07-04 11:50:56,374 - templ_pipeline.core.embedding - INFO - Loaded 18902 embeddings from /home/ubuntu/mcs/templ_pipeline/data/embeddings/protein_embeddings_base.npz
INFO: Loaded 18902 embeddings from /home/ubuntu/mcs/templ_pipeline/data/embeddings/protein_embeddings_base.npz
INFO: Using cached embedding for PDB: 6jap
INFO: Retrieved cached embedding with shape (1280,) for chain A
INFO: Step 2: Finding similar templates
INFO: Finding similar templates
2025-07-04 11:50:56,394 - templ_pipeline.core.embedding - INFO - Loaded 18902 embeddings from /home/ubuntu/mcs/templ_pipeline/data/embeddings/protein_embeddings_base.npz
INFO: Loaded 18902 embeddings from /home/ubuntu/mcs/templ_pipeline/data/embeddings/protein_embeddings_base.npz
INFO: Using cached embedding for PDB: 6qrc
INFO: Retrieved cached embedding with shape (1280,) for chain A
INFO: Step 2: Finding similar templates
INFO: Finding similar templates
2025-07-04 11:50:56,401 - templ_pipeline.core.embedding - INFO - Loaded 18902 embeddings from /home/ubuntu/mcs/templ_pipeline/data/embeddings/protein_embeddings_base.npz
INFO: Loaded 18902 embeddings from /home/ubuntu/mcs/templ_pipeline/data/embeddings/protein_embeddings_base.npz
INFO: Using cached embedding for PDB: 6jsn
INFO: Retrieved cached embedding with shape (1280,) for chain A
INFO: Step 2: Finding similar templates
INFO: Finding similar templates
2025-07-04 11:50:56,419 - templ_pipeline.core.embedding - INFO - Loaded 18902 embeddings from /home/ubuntu/mcs/templ_pipeline/data/embeddings/protein_embeddings_base.npz
INFO: Loaded 18902 embeddings from /home/ubuntu/mcs/templ_pipeline/data/embeddings/protein_embeddings_base.npz
INFO: Using cached embedding for PDB: 6oxq
INFO: Retrieved cached embedding with shape (1280,) for chain A
INFO: Step 2: Finding similar templates
INFO: Finding similar templates
INFO: Generating embedding for /home/ubuntu/mcs/templ_pipeline/data/PDBBind/PDBbind_v2020_refined/refined-set/6np2/6np2_protein.pdb
2025-07-04 11:50:56,520 - templ_pipeline.core.embedding - INFO - Found 100 neighbors for QUERY.
INFO: Found 100 neighbors for QUERY.
INFO: Found 100 templates
INFO: Step 3: Loading template molecules
INFO: Loading templates from: data/ligands/processed_ligands_new.sdf.gz (with error tolerance)
2025-07-04 11:50:56,538 - templ_pipeline.core.embedding - INFO - Found 100 neighbors for QUERY.
INFO: Found 100 neighbors for QUERY.
INFO: Found 100 templates
INFO: Step 3: Loading template molecules
INFO: Loading templates from: data/ligands/processed_ligands_new.sdf.gz (with error tolerance)
2025-07-04 11:50:56,612 - templ_pipeline.core.embedding - INFO - Found 100 neighbors for QUERY.
INFO: Found 100 neighbors for QUERY.
INFO: Found 100 templates
INFO: Step 3: Loading template molecules
INFO: Loading templates from: data/ligands/processed_ligands_new.sdf.gz (with error tolerance)
INFO: Generating embedding for /home/ubuntu/mcs/templ_pipeline/data/PDBBind/PDBbind_v2020_refined/refined-set/6jag/6jag_protein.pdb
2025-07-04 11:50:56,666 - templ_pipeline.core.embedding - INFO - Found 100 neighbors for QUERY.
INFO: Found 100 neighbors for QUERY.
INFO: Found 100 templates
INFO: Step 3: Loading template molecules
INFO: Loading templates from: data/ligands/processed_ligands_new.sdf.gz (with error tolerance)
2025-07-04 11:50:56,684 - templ_pipeline.core.embedding - INFO - Loaded 18902 embeddings from /home/ubuntu/mcs/templ_pipeline/data/embeddings/protein_embeddings_base.npz
INFO: Loaded 18902 embeddings from /home/ubuntu/mcs/templ_pipeline/data/embeddings/protein_embeddings_base.npz
INFO: Using cached embedding for PDB: 6hzb
INFO: Retrieved cached embedding with shape (1280,) for chain A
INFO: Step 2: Finding similar templates
INFO: Finding similar templates
INFO: Generating embedding for /home/ubuntu/mcs/templ_pipeline/data/PDBBind/PDBbind_v2020_other_PL/v2020-other-PL/6uvp/6uvp_protein.pdb
2025-07-04 11:50:56,711 - templ_pipeline.core.embedding - INFO - Found 100 neighbors for QUERY.
INFO: Found 100 neighbors for QUERY.
INFO: Found 100 templates
INFO: Step 3: Loading template molecules
INFO: Loading templates from: data/ligands/processed_ligands_new.sdf.gz (with error tolerance)
2025-07-04 11:50:56,839 - templ_pipeline.core.embedding - INFO - Loaded 18902 embeddings from /home/ubuntu/mcs/templ_pipeline/data/embeddings/protein_embeddings_base.npz
INFO: Loaded 18902 embeddings from /home/ubuntu/mcs/templ_pipeline/data/embeddings/protein_embeddings_base.npz
INFO: Using cached embedding for PDB: 6qqw
INFO: Retrieved cached embedding with shape (1280,) for chain A
INFO: Step 2: Finding similar templates
INFO: Finding similar templates
2025-07-04 11:50:56,905 - templ_pipeline.core.embedding - INFO - Found 100 neighbors for QUERY.
INFO: Found 100 neighbors for QUERY.
INFO: Found 100 templates
INFO: Step 3: Loading template molecules
INFO: Loading templates from: data/ligands/processed_ligands_new.sdf.gz (with error tolerance)
2025-07-04 11:50:57,076 - templ_pipeline.core.embedding - INFO - Loaded 18902 embeddings from /home/ubuntu/mcs/templ_pipeline/data/embeddings/protein_embeddings_base.npz
INFO: Loaded 18902 embeddings from /home/ubuntu/mcs/templ_pipeline/data/embeddings/protein_embeddings_base.npz
INFO: Using cached embedding for PDB: 6oio
INFO: Retrieved cached embedding with shape (1280,) for chain A
INFO: Step 2: Finding similar templates
INFO: Finding similar templates
2025-07-04 11:50:57,105 - templ_pipeline.core.embedding - INFO - Found 100 neighbors for QUERY.
INFO: Found 100 neighbors for QUERY.
INFO: Found 100 templates
INFO: Step 3: Loading template molecules
INFO: Loading templates from: data/ligands/processed_ligands_new.sdf.gz (with error tolerance)
2025-07-04 11:50:57,200 - templ_pipeline.core.embedding - INFO - Loaded 18902 embeddings from /home/ubuntu/mcs/templ_pipeline/data/embeddings/protein_embeddings_base.npz
INFO: Loaded 18902 embeddings from /home/ubuntu/mcs/templ_pipeline/data/embeddings/protein_embeddings_base.npz
INFO: Using cached embedding for PDB: 6jag
INFO: Retrieved cached embedding with shape (1280,) for chain A
INFO: Step 2: Finding similar templates
INFO: Finding similar templates
2025-07-04 11:50:57,312 - templ_pipeline.core.embedding - INFO - Found 100 neighbors for QUERY.
INFO: Found 100 neighbors for QUERY.
INFO: Found 100 templates
INFO: Step 3: Loading template molecules
INFO: Loading templates from: data/ligands/processed_ligands_new.sdf.gz (with error tolerance)
2025-07-04 11:50:57,406 - templ_pipeline.core.embedding - INFO - Found 100 neighbors for QUERY.
INFO: Found 100 neighbors for QUERY.
INFO: Found 100 templates
INFO: Step 3: Loading template molecules
INFO: Loading templates from: data/ligands/processed_ligands_new.sdf.gz (with error tolerance)
2025-07-04 11:50:57,490 - templ_pipeline.core.embedding - INFO - Loaded 18902 embeddings from /home/ubuntu/mcs/templ_pipeline/data/embeddings/protein_embeddings_base.npz
INFO: Loaded 18902 embeddings from /home/ubuntu/mcs/templ_pipeline/data/embeddings/protein_embeddings_base.npz
INFO: Using cached embedding for PDB: 6np2
INFO: Retrieved cached embedding with shape (1280,) for chain A
INFO: Step 2: Finding similar templates
INFO: Finding similar templates
2025-07-04 11:50:57,648 - templ_pipeline.core.embedding - INFO - Found 100 neighbors for QUERY.
INFO: Found 100 neighbors for QUERY.
INFO: Found 100 templates
INFO: Step 3: Loading template molecules
INFO: Loading templates from: data/ligands/processed_ligands_new.sdf.gz (with error tolerance)
2025-07-04 11:50:57,718 - templ_pipeline.core.embedding - INFO - Loaded 18902 embeddings from /home/ubuntu/mcs/templ_pipeline/data/embeddings/protein_embeddings_base.npz
INFO: Loaded 18902 embeddings from /home/ubuntu/mcs/templ_pipeline/data/embeddings/protein_embeddings_base.npz
INFO: Using cached embedding for PDB: 6uvp
INFO: Retrieved cached embedding with shape (1280,) for chain A
INFO: Step 2: Finding similar templates
INFO: Finding similar templates
2025-07-04 11:50:57,891 - templ_pipeline.core.embedding - INFO - Found 100 neighbors for QUERY.
INFO: Found 100 neighbors for QUERY.
INFO: Found 100 templates
INFO: Step 3: Loading template molecules
INFO: Loading templates from: data/ligands/processed_ligands_new.sdf.gz (with error tolerance)
INFO: Template loading complete: 100 templates loaded from 18902 processed
INFO: Loaded 100 template molecules using standardized loader
INFO: Step 4: Preparing query molecule
INFO: Creating molecule from SMILES: OC[C@H]1O[C@@](CO)(O[C@H]2O[C@H](CO)[C@@H](O)[C@H](O)[C@H]2O)[C@@H](O)[C@@H]1O
INFO: Template loading complete: 100 templates loaded from 18902 processed
INFO: Loaded 100 template molecules using standardized loader
INFO: Step 4: Preparing query molecule
INFO: Creating molecule from SMILES: C[C@]1(c2cc(NC(=O)c3cnc(OCF)cn3)ccc2F)NC(=[NH2+])SCC12CCS(=O)(=O)CC2
INFO: Query molecule prepared (standardized): 23 atoms, 24 bonds
INFO: Step 5: Generating poses (alignment=enabled)
INFO: Query molecule prepared (standardized): 34 atoms, 37 bonds
INFO: Step 5: Generating poses (alignment=enabled)
INFO: Generating poses with 100 templates, 200 conformers, 2 workers
INFO: Finding MCS and generating conformers
INFO: Generating conformers for unnamed_query using 100 templates: template_0, template_1, template_2...
INFO: Query molecule: 23 atoms, 24 bonds
INFO: MCS tiebreaker: selected template 62 with similarity 1.000
INFO: Selected template template_62 with MCS SMARTS: OCC1OC(-CO)(-OC2OC(-CO)-C(-O)-C(-O)-C2O)-C(-O)-C1O
INFO: Generating poses with 100 templates, 200 conformers, 2 workers
INFO: Finding MCS and generating conformers
INFO: Generating conformers for unnamed_query using 100 templates: template_0, template_1, template_2...
INFO: Query molecule: 34 atoms, 37 bonds
INFO: Selected template template_56 with MCS SMARTS: CC1(-c2:c:c(-NC(=O)-c3:c:n:c(-OCF):c:n:3):c:c:c:2-F)-NC(=N)-SCC12CCS(=O)(=O)-CC2
INFO: Template loading complete: 100 templates loaded from 18902 processed
INFO: Loaded 100 template molecules using standardized loader
INFO: Step 4: Preparing query molecule
INFO: Creating molecule from SMILES: Nc1cc(-c2ccc3ccn(Cc4ccccc4)c3c2)n[nH]1
INFO: Query molecule prepared (standardized): 22 atoms, 25 bonds
INFO: Step 5: Generating poses (alignment=enabled)
INFO: Generating poses with 100 templates, 200 conformers, 2 workers
INFO: Finding MCS and generating conformers
INFO: Generating conformers for unnamed_query using 100 templates: template_0, template_1, template_2...
INFO: Query molecule: 22 atoms, 25 bonds
INFO: Template loading complete: 100 templates loaded from 18902 processed
INFO: Loaded 100 template molecules using standardized loader
INFO: Step 4: Preparing query molecule
INFO: Creating molecule from SMILES: OC[C@H]1O[C@@](CO)(O[C@H]2O[C@H](CO)[C@@H](O)[C@H](O)[C@H]2O)[C@@H](O)[C@@H]1O
INFO: MCS tiebreaker: selected template 36 with similarity 1.000
INFO: Selected template template_36 with MCS SMARTS: Nc1:c:c(-c2:c:c:c3:c:c:n(-Cc4:c:c:c:c:c:4):c:3:c:2):n:n:1
INFO: Template loading complete: 100 templates loaded from 18902 processed
INFO: Loaded 100 template molecules using standardized loader
INFO: Step 4: Preparing query molecule
INFO: Creating molecule from SMILES: C[NH2+][C@@H]1[C@@H](O)[C@@H](O[C@@H]2[C@@H](O)[C@H](O[C@H]3OC(C[NH3+])=CC[C@H]3[NH3+])[C@@H]([NH3+])C[C@H]2[NH3+])OC[C@]1(C)O
INFO: Query molecule prepared (standardized): 23 atoms, 24 bonds
INFO: Step 5: Generating poses (alignment=enabled)
INFO: Generating poses with 100 templates, 200 conformers, 2 workers
INFO: Finding MCS and generating conformers
INFO: Generating conformers for unnamed_query using 100 templates: template_0, template_1, template_2...
INFO: Query molecule: 23 atoms, 24 bonds
INFO: Query molecule prepared (standardized): 31 atoms, 33 bonds
INFO: Step 5: Generating poses (alignment=enabled)
INFO: Template loading complete: 100 templates loaded from 18902 processed
INFO: Loaded 100 template molecules using standardized loader
INFO: Step 4: Preparing query molecule
INFO: Creating molecule from SMILES: CCC(CC)CN(C[C@@H](O)[C@H](Cc1ccccc1)NC(=O)O[C@H]1CO[C@H]2OCC[C@H]21)S(=O)(=O)c1ccc(CO)cc1
INFO: MCS tiebreaker: selected template 65 with similarity 1.000
INFO: Selected template template_65 with MCS SMARTS: OCC1OC(-CO)(-OC2OC(-CO)-C(-O)-C(-O)-C2O)-C(-O)-C1O
INFO: Template loading complete: 100 templates loaded from 18902 processed
INFO: Loaded 100 template molecules using standardized loader
INFO: Step 4: Preparing query molecule
INFO: Creating molecule from SMILES: COc1cccc(Cn2ccc3ccc(-c4cc(N)n[nH]4)cc32)c1
INFO: Generating poses with 100 templates, 200 conformers, 2 workers
INFO: Finding MCS and generating conformers
INFO: Generating conformers for unnamed_query using 100 templates: template_0, template_1, template_2...
INFO: Query molecule: 31 atoms, 33 bonds
INFO: MCS tiebreaker: selected template 33 with similarity 1.000
INFO: Selected template template_33 with MCS SMARTS: CNC1C(-O)-C(-OC2C(-O)-C(-OC3OC(-CN)=CCC3N)-C(-N)-CC2N)-OCC1(-C)-O
INFO: Query molecule prepared (standardized): 24 atoms, 27 bonds
INFO: Step 5: Generating poses (alignment=enabled)
INFO: Template loading complete: 100 templates loaded from 18902 processed
INFO: Loaded 100 template molecules using standardized loader
INFO: Step 4: Preparing query molecule
INFO: Creating molecule from SMILES: NC(=[NH2+])NCCC[C@@H]1NC(=O)CCCC(=O)NCCCC[C@@H](C(=O)N[C@@H](CCCC[NH3+])C(=O)NCc2ccc(C(N)=[NH2+])cc2)NC(=O)[C@H](CCCNC(N)=[NH2+])NC1=O
INFO: Template loading complete: 100 templates loaded from 18902 processed
INFO: Loaded 100 template molecules using standardized loader
INFO: Step 4: Preparing query molecule
INFO: Creating molecule from SMILES: C[C@H]([NH3+])C(=O)N[C@@H](CCCC[NH3+])C(=O)N[C@@H](CCC(N)=O)C(=O)N[C@H](C(=O)N[C@@H](C)C(=O)N[C@@H](CCCNC(N)=[NH2+])C(=O)N[C@@H](CCCC[NH2+]Cc1ccccc1)C(=O)N[C@@H](CO)C(=O)[O-])[C@@H](C)O
INFO: Generating poses with 100 templates, 200 conformers, 2 workers
INFO: Finding MCS and generating conformers
INFO: Generating conformers for unnamed_query using 100 templates: template_0, template_1, template_2...
INFO: Query molecule: 24 atoms, 27 bonds
INFO: Selected template template_54 with MCS SMARTS: COc1:c:c:c:c(-Cn2:c:c:c3:c:c:c(-c4:c:c(-N):n:n:4):c:c:2:3):c:1
INFO: Query molecule prepared (standardized): 41 atoms, 44 bonds
INFO: Step 5: Generating poses (alignment=enabled)
INFO: Template loading complete: 100 templates loaded from 18902 processed
INFO: Loaded 100 template molecules using standardized loader
INFO: Step 4: Preparing query molecule
INFO: Creating molecule from SMILES: [NH2+]=C1N[C@@]2([C@H]3C[C@@H]3NC(=O)c3ccc(F)cn3)COC[C@H]2CS1
INFO: Query molecule prepared (standardized): 23 atoms, 26 bonds
INFO: Step 5: Generating poses (alignment=enabled)
INFO: Generating poses with 100 templates, 200 conformers, 2 workers
INFO: Finding MCS and generating conformers
INFO: Generating conformers for unnamed_query using 100 templates: template_0, template_1, template_2...
INFO: Query molecule: 41 atoms, 44 bonds
INFO: Generating poses with 100 templates, 200 conformers, 2 workers
INFO: Finding MCS and generating conformers
INFO: Generating conformers for unnamed_query using 100 templates: template_0, template_1, template_2...
INFO: Query molecule: 23 atoms, 26 bonds
INFO: Selected template template_2 with MCS SMARTS: N=C1NC2(-C3CC3NC(=O)-c3:c:c:c(-F):c:n:3)-COCC2CS1
INFO: Query molecule prepared (standardized): 58 atoms, 59 bonds
INFO: Step 5: Generating poses (alignment=enabled)
INFO: MCS tiebreaker: selected template 3 with similarity 1.000
INFO: Selected template template_3 with MCS SMARTS: CCC(-CC)-CN(-CC(-O)-C(-Cc1:c:c:c:c:c:1)-NC(=O)-OC1COC2OCCC1-2)-S(=O)(=O)-c1:c:c:c(-CO):c:c:1
INFO: Generating poses with 100 templates, 200 conformers, 2 workers
INFO: Finding MCS and generating conformers
INFO: Generating conformers for unnamed_query using 100 templates: template_0, template_1, template_2...
INFO: Query molecule: 58 atoms, 59 bonds
INFO: Template loading complete: 100 templates loaded from 18902 processed
INFO: Loaded 100 template molecules using standardized loader
INFO: Step 4: Preparing query molecule
INFO: Creating molecule from SMILES: O=C(NNS(=O)(=O)c1ccccc1)c1cccc(-c2ccccc2)c1
INFO: Query molecule prepared (standardized): 25 atoms, 27 bonds
INFO: Step 5: Generating poses (alignment=enabled)
INFO: Generating poses with 100 templates, 200 conformers, 2 workers
INFO: Finding MCS and generating conformers
INFO: Generating conformers for unnamed_query using 100 templates: template_0, template_1, template_2...
INFO: Query molecule: 25 atoms, 27 bonds
INFO: MCS tiebreaker: selected template 42 with similarity 1.000
INFO: Selected template template_42 with MCS SMARTS: O=C(-NNS(=O)(=O)-c1:c:c:c:c:c:1)-c1:c:c:c:c(-c2:c:c:c:c:c:2):c:1
INFO: Query molecule prepared (standardized): 69 atoms, 69 bonds
INFO: Step 5: Generating poses (alignment=enabled)
INFO: Generating poses with 100 templates, 200 conformers, 2 workers
INFO: Finding MCS and generating conformers
INFO: Generating conformers for unnamed_query using 100 templates: template_0, template_1, template_2...
INFO: Query molecule: 69 atoms, 69 bonds
INFO: Successfully generated 200 conformers
INFO: DEBUG: mcs_atom_indices type: <class 'dict'>
INFO: DEBUG: mcs_atom_indices content: {'atom_count': 22, 'bond_count': 25, 'similarity_score': 0.9, 'query_atoms': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21], 'template_atoms': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21], 'smarts': 'Nc1:c:c(-c2:c:c:c3:c:c:n(-Cc4:c:c:c:c:c:4):c:3:c:2):n:n:1', 'organometallic_handling': {'target_had_metals': False, 'template_had_metals': False, 'target_substitutions': ['No organometallic atoms detected'], 'template_substitutions': ['No organometallic atoms detected']}, 'selected_template_index': 36}
INFO: MCS info captured for template selection
INFO: Generated 200/200 conformers
INFO: Scoring and selecting best poses (aligned_poses=True)
INFO: Scoring 200 conformers using 2 workers
INFO: Successfully generated 200 conformers
INFO: DEBUG: mcs_atom_indices type: <class 'dict'>
INFO: DEBUG: mcs_atom_indices content: {'atom_count': 25, 'bond_count': 27, 'similarity_score': 0.9, 'query_atoms': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24], 'template_atoms': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24], 'smarts': 'O=C(-NNS(=O)(=O)-c1:c:c:c:c:c:1)-c1:c:c:c:c(-c2:c:c:c:c:c:2):c:1', 'organometallic_handling': {'target_had_metals': False, 'template_had_metals': False, 'target_substitutions': ['No organometallic atoms detected'], 'template_substitutions': ['No organometallic atoms detected']}, 'selected_template_index': 42}
INFO: MCS info captured for template selection
INFO: Generated 200/200 conformers
INFO: Scoring and selecting best poses (aligned_poses=True)
INFO: Scoring 200 conformers using 2 workers
INFO: Successfully generated 200 conformers
INFO: DEBUG: mcs_atom_indices type: <class 'dict'>
INFO: DEBUG: mcs_atom_indices content: {'atom_count': 24, 'bond_count': 27, 'similarity_score': 0.9, 'query_atoms': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23], 'template_atoms': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23], 'smarts': 'COc1:c:c:c:c(-Cn2:c:c:c3:c:c:c(-c4:c:c(-N):n:n:4):c:c:2:3):c:1', 'organometallic_handling': {'target_had_metals': False, 'template_had_metals': False, 'target_substitutions': ['No organometallic atoms detected'], 'template_substitutions': ['No organometallic atoms detected']}, 'selected_template_index': 54}
INFO: MCS info captured for template selection
INFO: Generated 200/200 conformers
INFO: Scoring and selecting best poses (aligned_poses=True)
INFO: Scoring 200 conformers using 2 workers
INFO: Successfully generated 200 conformers
INFO: DEBUG: mcs_atom_indices type: <class 'dict'>
INFO: DEBUG: mcs_atom_indices content: {'atom_count': 23, 'bond_count': 24, 'similarity_score': 0.9, 'query_atoms': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22], 'template_atoms': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22], 'smarts': 'OCC1OC(-CO)(-OC2OC(-CO)-C(-O)-C(-O)-C2O)-C(-O)-C1O', 'organometallic_handling': {'target_had_metals': False, 'template_had_metals': False, 'target_substitutions': ['No organometallic atoms detected'], 'template_substitutions': ['No organometallic atoms detected']}, 'selected_template_index': 65}
INFO: MCS info captured for template selection
INFO: Generated 200/200 conformers
INFO: Scoring and selecting best poses (aligned_poses=True)
INFO: Scoring 200 conformers using 2 workers
INFO: Successfully generated 200 conformers
INFO: DEBUG: mcs_atom_indices type: <class 'dict'>
INFO: DEBUG: mcs_atom_indices content: {'atom_count': 23, 'bond_count': 24, 'similarity_score': 0.9, 'query_atoms': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22], 'template_atoms': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22], 'smarts': 'OCC1OC(-CO)(-OC2OC(-CO)-C(-O)-C(-O)-C2O)-C(-O)-C1O', 'organometallic_handling': {'target_had_metals': False, 'template_had_metals': False, 'target_substitutions': ['No organometallic atoms detected'], 'template_substitutions': ['No organometallic atoms detected']}, 'selected_template_index': 62}
INFO: MCS info captured for template selection
INFO: Generated 200/200 conformers
INFO: Scoring and selecting best poses (aligned_poses=True)
INFO: Scoring 200 conformers using 2 workers
INFO: Successfully generated 200 conformers
INFO: DEBUG: mcs_atom_indices type: <class 'dict'>
INFO: DEBUG: mcs_atom_indices content: {'atom_count': 23, 'bond_count': 26, 'similarity_score': 0.9, 'query_atoms': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22], 'template_atoms': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22], 'smarts': 'N=C1NC2(-C3CC3NC(=O)-c3:c:c:c(-F):c:n:3)-COCC2CS1', 'organometallic_handling': {'target_had_metals': False, 'template_had_metals': False, 'target_substitutions': ['No organometallic atoms detected'], 'template_substitutions': ['No organometallic atoms detected']}, 'selected_template_index': 2}
INFO: MCS info captured for template selection
INFO: Generated 200/200 conformers
INFO: Scoring and selecting best poses (aligned_poses=True)
INFO: Scoring 200 conformers using 2 workers
INFO: Successfully generated 200 conformers
INFO: DEBUG: mcs_atom_indices type: <class 'dict'>
INFO: DEBUG: mcs_atom_indices content: {'atom_count': 34, 'bond_count': 37, 'similarity_score': 0.9, 'query_atoms': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33], 'template_atoms': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33], 'smarts': 'CC1(-c2:c:c(-NC(=O)-c3:c:n:c(-OCF):c:n:3):c:c:c:2-F)-NC(=N)-SCC12CCS(=O)(=O)-CC2', 'organometallic_handling': {'target_had_metals': False, 'template_had_metals': False, 'target_substitutions': ['No organometallic atoms detected'], 'template_substitutions': ['No organometallic atoms detected']}, 'selected_template_index': 56}
INFO: MCS info captured for template selection
INFO: Generated 200/200 conformers
INFO: Scoring and selecting best poses (aligned_poses=True)
INFO: Scoring 200 conformers using 2 workers
INFO: Generated 3 best poses, 200 total ranked poses
INFO: Step 6: Saving results
INFO: Output manager initialized: benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115111
INFO: Metadata exported to JSON: benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115111/6qqw_20250704_115111_poses_metadata.json
INFO: FAIR metadata saved to benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115111/6qqw_20250704_115111_poses_metadata.json
INFO: Saved 3 poses to benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115111/6qqw_20250704_115111_poses.sdf
INFO: Pipeline completed successfully (alignment_used=True)
INFO: Successfully calculated RMSD for 3 metrics
INFO: TEMPL completed for 6qqw in 19.9s
INFO: Generated 3 best poses, 200 total ranked poses
INFO: Step 6: Saving results
INFO: Output manager initialized: benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115114
INFO: Generated 3 best poses, 200 total ranked poses
INFO: Step 6: Saving results
INFO: Output manager initialized: benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115114
INFO: Error tracking enabled
INFO: TEMPL pipeline initialized with 0.1GB memory usage
INFO: Shared cache not available, loading individually
INFO: Loading molecules from processed_ligands_new.sdf.gz...
INFO: Metadata exported to JSON: benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115114/6oio_20250704_115114_poses_metadata.json
INFO: FAIR metadata saved to benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115114/6oio_20250704_115114_poses_metadata.json
INFO: Saved 3 poses to benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115114/6oio_20250704_115114_poses.sdf
INFO: Pipeline completed successfully (alignment_used=True)
INFO: Metadata exported to JSON: benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115114/6qrc_20250704_115114_poses_metadata.json
INFO: FAIR metadata saved to benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115114/6qrc_20250704_115114_poses_metadata.json
INFO: Saved 3 poses to benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115114/6qrc_20250704_115114_poses.sdf
INFO: Pipeline completed successfully (alignment_used=True)
INFO: Successfully calculated RMSD for 3 metrics
INFO: Successfully calculated RMSD for 3 metrics
INFO: TEMPL completed for 6oio in 22.6s
INFO: Generated 3 best poses, 200 total ranked poses
INFO: Step 6: Saving results
INFO: Output manager initialized: benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115115
INFO: TEMPL completed for 6qrc in 22.8s
INFO: Generated 3 best poses, 200 total ranked poses
INFO: Step 6: Saving results
INFO: Output manager initialized: benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115115
INFO: Metadata exported to JSON: benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115115/6jag_20250704_115115_poses_metadata.json
INFO: FAIR metadata saved to benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115115/6jag_20250704_115115_poses_metadata.json
INFO: Saved 3 poses to benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115115/6jag_20250704_115115_poses.sdf
INFO: Pipeline completed successfully (alignment_used=True)
INFO: Metadata exported to JSON: benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115115/6uvp_20250704_115115_poses_metadata.json
INFO: FAIR metadata saved to benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115115/6uvp_20250704_115115_poses_metadata.json
INFO: Saved 3 poses to benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115115/6uvp_20250704_115115_poses.sdf
INFO: Pipeline completed successfully (alignment_used=True)
INFO: Successfully calculated RMSD for 3 metrics
INFO: Successfully calculated RMSD for 3 metrics
INFO: TEMPL completed for 6jag in 23.7s
INFO: TEMPL completed for 6uvp in 23.8s
INFO: Generated 3 best poses, 200 total ranked poses
INFO: Step 6: Saving results
INFO: Output manager initialized: benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115116
INFO: Metadata exported to JSON: benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115116/6jap_20250704_115116_poses_metadata.json
INFO: FAIR metadata saved to benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115116/6jap_20250704_115116_poses_metadata.json
INFO: Saved 3 poses to benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115116/6jap_20250704_115116_poses.sdf
INFO: Pipeline completed successfully (alignment_used=True)
INFO: Successfully calculated RMSD for 3 metrics
INFO: Loaded 18902 molecules from processed_ligands_new.sdf.gz (skipped 0)
INFO: Memory used for loading: 0.4GB
INFO: Loaded 18902 molecules into cache
INFO: Running TEMPL pipeline for 6moa
INFO: Starting pipeline execution for 6moa
INFO: Step 1: Generating protein embedding
INFO: TEMPL completed for 6jap in 24.9s
INFO: Error tracking enabled
INFO: TEMPL pipeline initialized with 0.1GB memory usage
INFO: Shared cache not available, loading individually
INFO: Loading molecules from processed_ligands_new.sdf.gz...
INFO: Generating embedding for /home/ubuntu/mcs/templ_pipeline/data/PDBBind/PDBbind_v2020_other_PL/v2020-other-PL/6moa/6moa_protein.pdb
2025-07-04 11:51:18,617 - templ_pipeline.core.embedding - INFO - Loaded 18902 embeddings from /home/ubuntu/mcs/templ_pipeline/data/embeddings/protein_embeddings_base.npz
INFO: Loaded 18902 embeddings from /home/ubuntu/mcs/templ_pipeline/data/embeddings/protein_embeddings_base.npz
INFO: Using cached embedding for PDB: 6moa
INFO: Retrieved cached embedding with shape (1280,) for chain A
INFO: Step 2: Finding similar templates
INFO: Finding similar templates
2025-07-04 11:51:18,723 - templ_pipeline.core.embedding - INFO - Found 100 neighbors for QUERY.
INFO: Found 100 neighbors for QUERY.
INFO: Found 100 templates
INFO: Step 3: Loading template molecules
INFO: Loading templates from: data/ligands/processed_ligands_new.sdf.gz (with error tolerance)
INFO: Error tracking enabled
INFO: TEMPL pipeline initialized with 0.1GB memory usage
INFO: Shared cache not available, loading individually
INFO: Loading molecules from processed_ligands_new.sdf.gz...
INFO: Error tracking enabled
INFO: TEMPL pipeline initialized with 0.1GB memory usage
INFO: Shared cache not available, loading individually
INFO: Loading molecules from processed_ligands_new.sdf.gz...
INFO: Error tracking enabled
INFO: TEMPL pipeline initialized with 0.1GB memory usage
INFO: Shared cache not available, loading individually
INFO: Loading molecules from processed_ligands_new.sdf.gz...
INFO: Error tracking enabled
INFO: TEMPL pipeline initialized with 0.1GB memory usage
INFO: Shared cache not available, loading individually
INFO: Loading molecules from processed_ligands_new.sdf.gz...
INFO: Successfully generated 200 conformers
INFO: DEBUG: mcs_atom_indices type: <class 'dict'>
INFO: DEBUG: mcs_atom_indices content: {'atom_count': 31, 'bond_count': 33, 'similarity_score': 0.9, 'query_atoms': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30], 'template_atoms': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30], 'smarts': 'CNC1C(-O)-C(-OC2C(-O)-C(-OC3OC(-CN)=CCC3N)-C(-N)-CC2N)-OCC1(-C)-O', 'organometallic_handling': {'target_had_metals': False, 'template_had_metals': False, 'target_substitutions': ['No organometallic atoms detected'], 'template_substitutions': ['No organometallic atoms detected']}, 'selected_template_index': 33}
INFO: MCS info captured for template selection
INFO: Generated 200/200 conformers
INFO: Scoring and selecting best poses (aligned_poses=True)
INFO: Scoring 200 conformers using 2 workers
INFO: Template loading complete: 100 templates loaded from 18902 processed
INFO: Loaded 100 template molecules using standardized loader
INFO: Step 4: Preparing query molecule
INFO: Creating molecule from SMILES: Cc1ccc2ncccc2c1-c1cc(-c2c(C)noc2C)cc2[nH]c(C3CC3)nc12
INFO: Query molecule prepared (standardized): 30 atoms, 35 bonds
INFO: Step 5: Generating poses (alignment=enabled)
INFO: Loaded 18902 molecules from processed_ligands_new.sdf.gz (skipped 0)
INFO: Memory used for loading: 0.4GB
INFO: Loaded 18902 molecules into cache
INFO: Running TEMPL pipeline for 6g24
INFO: Starting pipeline execution for 6g24
INFO: Step 1: Generating protein embedding
INFO: Generating poses with 100 templates, 200 conformers, 2 workers
INFO: Finding MCS and generating conformers
INFO: Generating conformers for unnamed_query using 100 templates: template_0, template_1, template_2...
INFO: Query molecule: 30 atoms, 35 bonds
INFO: Selected template template_71 with MCS SMARTS: Cc1:c:c:c2:n:c:c:c:c:2:c:1-c1:c:c(-c2:c(-C):n:o:c:2-C):c:c2:n:c(-C3CC3):n:c:1:2
INFO: Loaded 18902 molecules from processed_ligands_new.sdf.gz (skipped 0)
INFO: Memory used for loading: 0.4GB
INFO: Loaded 18902 molecules into cache
INFO: Running TEMPL pipeline for 6hld
INFO: Starting pipeline execution for 6hld
INFO: Step 1: Generating protein embedding
INFO: Generating embedding for /home/ubuntu/mcs/templ_pipeline/data/PDBBind/PDBbind_v2020_refined/refined-set/6g24/6g24_protein.pdb
INFO: Loaded 18902 molecules from processed_ligands_new.sdf.gz (skipped 0)
INFO: Memory used for loading: 0.4GB
INFO: Loaded 18902 molecules into cache
INFO: Running TEMPL pipeline for 6e4c
INFO: Starting pipeline execution for 6e4c
INFO: Step 1: Generating protein embedding
INFO: Loaded 18902 molecules from processed_ligands_new.sdf.gz (skipped 0)
INFO: Memory used for loading: 0.4GB
INFO: Loaded 18902 molecules into cache
INFO: Generating embedding for /home/ubuntu/mcs/templ_pipeline/data/PDBBind/PDBbind_v2020_other_PL/v2020-other-PL/6hld/6hld_protein.pdb
INFO: Running TEMPL pipeline for 6jb4
INFO: Starting pipeline execution for 6jb4
INFO: Step 1: Generating protein embedding
2025-07-04 11:51:22,188 - templ_pipeline.core.embedding - INFO - Loaded 18902 embeddings from /home/ubuntu/mcs/templ_pipeline/data/embeddings/protein_embeddings_base.npz
INFO: Loaded 18902 embeddings from /home/ubuntu/mcs/templ_pipeline/data/embeddings/protein_embeddings_base.npz
INFO: Using cached embedding for PDB: 6g24
INFO: Retrieved cached embedding with shape (1280,) for chain A
INFO: Step 2: Finding similar templates
INFO: Finding similar templates
2025-07-04 11:51:22,309 - templ_pipeline.core.embedding - INFO - Found 100 neighbors for QUERY.
INFO: Found 100 neighbors for QUERY.
INFO: Found 100 templates
INFO: Step 3: Loading template molecules
INFO: Loading templates from: data/ligands/processed_ligands_new.sdf.gz (with error tolerance)
INFO: Generating embedding for /home/ubuntu/mcs/templ_pipeline/data/PDBBind/PDBbind_v2020_other_PL/v2020-other-PL/6e4c/6e4c_protein.pdb
2025-07-04 11:51:22,484 - templ_pipeline.core.embedding - INFO - Loaded 18902 embeddings from /home/ubuntu/mcs/templ_pipeline/data/embeddings/protein_embeddings_base.npz
INFO: Loaded 18902 embeddings from /home/ubuntu/mcs/templ_pipeline/data/embeddings/protein_embeddings_base.npz
INFO: Using cached embedding for PDB: 6hld
INFO: Retrieved cached embedding with shape (1280,) for chain A
INFO: Step 2: Finding similar templates
INFO: Finding similar templates
INFO: Generating embedding for /home/ubuntu/mcs/templ_pipeline/data/PDBBind/PDBbind_v2020_refined/refined-set/6jb4/6jb4_protein.pdb
2025-07-04 11:51:22,599 - templ_pipeline.core.embedding - INFO - Found 100 neighbors for QUERY.
INFO: Found 100 neighbors for QUERY.
INFO: Found 100 templates
INFO: Step 3: Loading template molecules
INFO: Loading templates from: data/ligands/processed_ligands_new.sdf.gz (with error tolerance)
INFO: Loaded 18902 molecules from processed_ligands_new.sdf.gz (skipped 0)
INFO: Memory used for loading: 0.4GB
INFO: Loaded 18902 molecules into cache
INFO: Running TEMPL pipeline for 6i9a
INFO: Starting pipeline execution for 6i9a
INFO: Step 1: Generating protein embedding
2025-07-04 11:51:22,947 - templ_pipeline.core.embedding - INFO - Loaded 18902 embeddings from /home/ubuntu/mcs/templ_pipeline/data/embeddings/protein_embeddings_base.npz
INFO: Loaded 18902 embeddings from /home/ubuntu/mcs/templ_pipeline/data/embeddings/protein_embeddings_base.npz
INFO: Using cached embedding for PDB: 6e4c
INFO: Retrieved cached embedding with shape (1280,) for chain A
INFO: Step 2: Finding similar templates
INFO: Finding similar templates
2025-07-04 11:51:23,050 - templ_pipeline.core.embedding - INFO - Found 100 neighbors for QUERY.
INFO: Found 100 neighbors for QUERY.
INFO: Found 100 templates
INFO: Step 3: Loading template molecules
INFO: Loading templates from: data/ligands/processed_ligands_new.sdf.gz (with error tolerance)
INFO: Generated 3 best poses, 200 total ranked poses
INFO: Step 6: Saving results
INFO: Output manager initialized: benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115123
INFO: Generating embedding for /home/ubuntu/mcs/templ_pipeline/data/PDBBind/PDBbind_v2020_other_PL/v2020-other-PL/6i9a/6i9a_protein.pdb
2025-07-04 11:51:23,382 - templ_pipeline.core.embedding - INFO - Loaded 18902 embeddings from /home/ubuntu/mcs/templ_pipeline/data/embeddings/protein_embeddings_base.npz
INFO: Loaded 18902 embeddings from /home/ubuntu/mcs/templ_pipeline/data/embeddings/protein_embeddings_base.npz
INFO: Using cached embedding for PDB: 6jb4
INFO: Retrieved cached embedding with shape (1280,) for chain A
INFO: Step 2: Finding similar templates
INFO: Finding similar templates
2025-07-04 11:51:23,551 - templ_pipeline.core.embedding - INFO - Found 100 neighbors for QUERY.
INFO: Found 100 neighbors for QUERY.
INFO: Found 100 templates
INFO: Step 3: Loading template molecules
INFO: Loading templates from: data/ligands/processed_ligands_new.sdf.gz (with error tolerance)
2025-07-04 11:51:23,613 - templ_pipeline.core.embedding - INFO - Loaded 18902 embeddings from /home/ubuntu/mcs/templ_pipeline/data/embeddings/protein_embeddings_base.npz
INFO: Loaded 18902 embeddings from /home/ubuntu/mcs/templ_pipeline/data/embeddings/protein_embeddings_base.npz
INFO: Using cached embedding for PDB: 6i9a
INFO: Retrieved cached embedding with shape (1280,) for chain A
INFO: Step 2: Finding similar templates
INFO: Finding similar templates
INFO: Metadata exported to JSON: benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115123/6jsn_20250704_115123_poses_metadata.json
INFO: FAIR metadata saved to benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115123/6jsn_20250704_115123_poses_metadata.json
INFO: Saved 3 poses to benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115123/6jsn_20250704_115123_poses.sdf
INFO: Pipeline completed successfully (alignment_used=True)
2025-07-04 11:51:23,714 - templ_pipeline.core.embedding - INFO - Found 100 neighbors for QUERY.
INFO: Found 100 neighbors for QUERY.
INFO: Found 100 templates
INFO: Step 3: Loading template molecules
INFO: Loading templates from: data/ligands/processed_ligands_new.sdf.gz (with error tolerance)
INFO: Successfully calculated RMSD for 3 metrics
INFO: TEMPL completed for 6jsn in 31.3s
INFO: Successfully generated 200 conformers
INFO: DEBUG: mcs_atom_indices type: <class 'dict'>
INFO: DEBUG: mcs_atom_indices content: {'atom_count': 41, 'bond_count': 44, 'similarity_score': 0.9, 'query_atoms': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], 'template_atoms': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], 'smarts': 'CCC(-CC)-CN(-CC(-O)-C(-Cc1:c:c:c:c:c:1)-NC(=O)-OC1COC2OCCC1-2)-S(=O)(=O)-c1:c:c:c(-CO):c:c:1', 'organometallic_handling': {'target_had_metals': False, 'template_had_metals': False, 'target_substitutions': ['No organometallic atoms detected'], 'template_substitutions': ['No organometallic atoms detected']}, 'selected_template_index': 3}
INFO: MCS info captured for template selection
INFO: Generated 200/200 conformers
INFO: Scoring and selecting best poses (aligned_poses=True)
INFO: Scoring 200 conformers using 2 workers
INFO: Template loading complete: 100 templates loaded from 18902 processed
INFO: Loaded 100 template molecules using standardized loader
INFO: Step 4: Preparing query molecule
INFO: Creating molecule from SMILES: O=C([O-])c1ccccc1/C=C/c1cccs1
INFO: Query molecule prepared (standardized): 16 atoms, 17 bonds
INFO: Step 5: Generating poses (alignment=enabled)
INFO: Generating poses with 100 templates, 200 conformers, 2 workers
INFO: Finding MCS and generating conformers
INFO: Generating conformers for unnamed_query using 100 templates: template_0, template_1, template_2...
INFO: Query molecule: 16 atoms, 17 bonds
INFO: Selected template template_2 with MCS SMARTS: O=C(-O)-c1:c:c:c:c:c:1-C=Cc1:c:c:c:s:1
INFO: Template loading complete: 100 templates loaded from 18902 processed
INFO: Loaded 100 template molecules using standardized loader
INFO: Step 4: Preparing query molecule
INFO: Creating molecule from SMILES: Cc1cc(-c2noc(=O)[nH]2)ccc1C1=CC(=O)C(O)C(C(=O)[O-])=N1
INFO: Template loading complete: 100 templates loaded from 18902 processed
INFO: Loaded 100 template molecules using standardized loader
INFO: Step 4: Preparing query molecule
INFO: Creating molecule from SMILES: NC(=[NH2+])NCCC[C@H](NC(=O)[C@H](CCCNC(N)=[NH2+])NC(=O)[C@H](CCCNC(N)=[NH2+])NC(=O)[C@@H]([NH3+])Cc1cccc2ccccc12)C(=O)N[C@@H](CCCC[NH3+])C(=O)N[C@@H](CCCC[NH3+])C(=O)NCc1ccc(C(N)=[NH2+])cc1
INFO: Query molecule prepared (standardized): 24 atoms, 26 bonds
INFO: Step 5: Generating poses (alignment=enabled)
INFO: Generating poses with 100 templates, 200 conformers, 2 workers
INFO: Finding MCS and generating conformers
INFO: Generating conformers for unnamed_query using 100 templates: template_0, template_1, template_2...
INFO: Query molecule: 24 atoms, 26 bonds
INFO: Selected template template_51 with MCS SMARTS: Cc1:c:c(-c2:n:o:c(=O):n:2):c:c:c:1-C1=CC(=O)-C(-O)-C(-C(=O)-O)=N1
INFO: Error tracking enabled
INFO: TEMPL pipeline initialized with 0.1GB memory usage
INFO: Shared cache not available, loading individually
INFO: Loading molecules from processed_ligands_new.sdf.gz...
INFO: Query molecule prepared (standardized): 77 atoms, 79 bonds
INFO: Step 5: Generating poses (alignment=enabled)
INFO: Generating poses with 100 templates, 200 conformers, 2 workers
INFO: Finding MCS and generating conformers
INFO: Generating conformers for unnamed_query using 100 templates: template_0, template_1, template_2...
INFO: Query molecule: 77 atoms, 79 bonds
INFO: Template loading complete: 100 templates loaded from 18902 processed
INFO: Loaded 100 template molecules using standardized loader
INFO: Step 4: Preparing query molecule
INFO: Creating molecule from SMILES: CN(NC(=O)CC[C@H](NC(=O)OCc1ccccc1)C(=O)N[C@@H](CCCC[NH3+])[C@H](O)C(=O)NCc1ccccc1)c1ccccc1
INFO: Template loading complete: 100 templates loaded from 18902 processed
INFO: Loaded 100 template molecules using standardized loader
INFO: Step 4: Preparing query molecule
INFO: Creating molecule from SMILES: OC[C@H]1O[C@H](O[C@H]2[C@H](O)[C@@H](O)[C@@H](O)O[C@@H]2CO)[C@H](O)[C@@H](O)[C@@H]1O
INFO: Query molecule prepared (standardized): 23 atoms, 24 bonds
INFO: Step 5: Generating poses (alignment=enabled)
INFO: Generating poses with 100 templates, 200 conformers, 2 workers
INFO: Finding MCS and generating conformers
INFO: Generating conformers for unnamed_query using 100 templates: template_0, template_1, template_2...
INFO: Query molecule: 23 atoms, 24 bonds
INFO: MCS tiebreaker: selected template 53 with similarity 1.000
INFO: Selected template template_53 with MCS SMARTS: OCC1OC(-OC2C(-O)-C(-O)-C(-O)-OC2CO)-C(-O)-C(-O)-C1O
INFO: Query molecule prepared (standardized): 46 atoms, 48 bonds
INFO: Step 5: Generating poses (alignment=enabled)
INFO: Generating poses with 100 templates, 200 conformers, 2 workers
INFO: Finding MCS and generating conformers
INFO: Generating conformers for unnamed_query using 100 templates: template_0, template_1, template_2...
INFO: Query molecule: 46 atoms, 48 bonds
INFO: Selected template template_30 with MCS SMARTS: CN(-NC(=O)-CCC(-NC(=O)-OCc1:c:c:c:c:c:1)-C(=O)-NC(-CCCCN)-C(-O)-C(=O)-NCc1:c:c:c:c:c:1)-c1:c:c:c:c:c:1
INFO: Successfully generated 200 conformers
INFO: DEBUG: mcs_atom_indices type: <class 'dict'>
INFO: DEBUG: mcs_atom_indices content: {'atom_count': 16, 'bond_count': 17, 'similarity_score': 0.9, 'query_atoms': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'template_atoms': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'smarts': 'O=C(-O)-c1:c:c:c:c:c:1-C=Cc1:c:c:c:s:1', 'organometallic_handling': {'target_had_metals': False, 'template_had_metals': False, 'target_substitutions': ['No organometallic atoms detected'], 'template_substitutions': ['No organometallic atoms detected']}, 'selected_template_index': 2}
INFO: MCS info captured for template selection
INFO: Generated 200/200 conformers
INFO: Scoring and selecting best poses (aligned_poses=True)
INFO: Scoring 200 conformers using 2 workers
INFO: Successfully generated 200 conformers
INFO: DEBUG: mcs_atom_indices type: <class 'dict'>
INFO: DEBUG: mcs_atom_indices content: {'atom_count': 30, 'bond_count': 35, 'similarity_score': 0.9, 'query_atoms': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29], 'template_atoms': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29], 'smarts': 'Cc1:c:c:c2:n:c:c:c:c:2:c:1-c1:c:c(-c2:c(-C):n:o:c:2-C):c:c2:n:c(-C3CC3):n:c:1:2', 'organometallic_handling': {'target_had_metals': False, 'template_had_metals': False, 'target_substitutions': ['No organometallic atoms detected'], 'template_substitutions': ['No organometallic atoms detected']}, 'selected_template_index': 71}
INFO: MCS info captured for template selection
INFO: Generated 200/200 conformers
INFO: Scoring and selecting best poses (aligned_poses=True)
INFO: Scoring 200 conformers using 2 workers
INFO: Loaded 18902 molecules from processed_ligands_new.sdf.gz (skipped 0)
INFO: Memory used for loading: 0.4GB
INFO: Loaded 18902 molecules into cache
INFO: Running TEMPL pipeline for 6s55
INFO: Starting pipeline execution for 6s55
INFO: Step 1: Generating protein embedding
INFO: Successfully generated 200 conformers
INFO: DEBUG: mcs_atom_indices type: <class 'dict'>
INFO: DEBUG: mcs_atom_indices content: {'atom_count': 24, 'bond_count': 26, 'similarity_score': 0.9, 'query_atoms': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23], 'template_atoms': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23], 'smarts': 'Cc1:c:c(-c2:n:o:c(=O):n:2):c:c:c:1-C1=CC(=O)-C(-O)-C(-C(=O)-O)=N1', 'organometallic_handling': {'target_had_metals': False, 'template_had_metals': False, 'target_substitutions': ['No organometallic atoms detected'], 'template_substitutions': ['No organometallic atoms detected']}, 'selected_template_index': 51}
INFO: MCS info captured for template selection
INFO: Generated 200/200 conformers
INFO: Scoring and selecting best poses (aligned_poses=True)
INFO: Scoring 200 conformers using 2 workers
INFO: Generating embedding for /home/ubuntu/mcs/templ_pipeline/data/PDBBind/PDBbind_v2020_other_PL/v2020-other-PL/6s55/6s55_protein.pdb
2025-07-04 11:51:31,314 - templ_pipeline.core.embedding - INFO - Loaded 18902 embeddings from /home/ubuntu/mcs/templ_pipeline/data/embeddings/protein_embeddings_base.npz
INFO: Loaded 18902 embeddings from /home/ubuntu/mcs/templ_pipeline/data/embeddings/protein_embeddings_base.npz
INFO: Using cached embedding for PDB: 6s55
INFO: Retrieved cached embedding with shape (1280,) for chain A
INFO: Step 2: Finding similar templates
INFO: Finding similar templates
2025-07-04 11:51:31,439 - templ_pipeline.core.embedding - INFO - Found 100 neighbors for QUERY.
INFO: Found 100 neighbors for QUERY.
INFO: Found 100 templates
INFO: Step 3: Loading template molecules
INFO: Loading templates from: data/ligands/processed_ligands_new.sdf.gz (with error tolerance)
INFO: Generated 3 best poses, 200 total ranked poses
INFO: Step 6: Saving results
INFO: Output manager initialized: benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115132
INFO: Metadata exported to JSON: benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115132/6g24_20250704_115132_poses_metadata.json
INFO: FAIR metadata saved to benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115132/6g24_20250704_115132_poses_metadata.json
INFO: Saved 3 poses to benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115132/6g24_20250704_115132_poses.sdf
INFO: Pipeline completed successfully (alignment_used=True)
INFO: Successfully calculated RMSD for 3 metrics
INFO: TEMPL completed for 6g24 in 14.5s
INFO: Successfully generated 200 conformers
INFO: DEBUG: mcs_atom_indices type: <class 'dict'>
INFO: DEBUG: mcs_atom_indices content: {'atom_count': 23, 'bond_count': 24, 'similarity_score': 0.9, 'query_atoms': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22], 'template_atoms': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22], 'smarts': 'OCC1OC(-OC2C(-O)-C(-O)-C(-O)-OC2CO)-C(-O)-C(-O)-C1O', 'organometallic_handling': {'target_had_metals': False, 'template_had_metals': False, 'target_substitutions': ['No organometallic atoms detected'], 'template_substitutions': ['No organometallic atoms detected']}, 'selected_template_index': 53}
INFO: MCS info captured for template selection
INFO: Generated 200/200 conformers
INFO: Scoring and selecting best poses (aligned_poses=True)
INFO: Scoring 200 conformers using 2 workers
INFO: Template loading complete: 100 templates loaded from 18902 processed
INFO: Loaded 100 template molecules using standardized loader
INFO: Step 4: Preparing query molecule
INFO: Creating molecule from SMILES: C[C@H]1CCCN(S(=O)(=O)c2cc(NC(=O)CN3C(=O)CNC3=O)ccc2Br)C1
INFO: Query molecule prepared (standardized): 28 atoms, 30 bonds
INFO: Step 5: Generating poses (alignment=enabled)
INFO: Generating poses with 100 templates, 200 conformers, 2 workers
INFO: Finding MCS and generating conformers
INFO: Generating conformers for unnamed_query using 100 templates: template_0, template_1, template_2...
INFO: Query molecule: 28 atoms, 30 bonds
INFO: Selected template template_78 with MCS SMARTS: CC1CCCN(-S(=O)(=O)-c2:c:c(-NC(=O)-CN3C(=O)-CNC3=O):c:c:c:2-Br)-C1
INFO: Error tracking enabled
INFO: TEMPL pipeline initialized with 0.1GB memory usage
INFO: Shared cache not available, loading individually
INFO: Loading molecules from processed_ligands_new.sdf.gz...
INFO: Generated 3 best poses, 200 total ranked poses
INFO: Step 6: Saving results
INFO: Output manager initialized: benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115136
INFO: Metadata exported to JSON: benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115136/6np2_20250704_115136_poses_metadata.json
INFO: FAIR metadata saved to benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115136/6np2_20250704_115136_poses_metadata.json
INFO: Saved 3 poses to benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115136/6np2_20250704_115136_poses.sdf
INFO: Pipeline completed successfully (alignment_used=True)
INFO: Successfully calculated RMSD for 3 metrics
INFO: TEMPL completed for 6np2 in 44.2s
INFO: Generated 3 best poses, 200 total ranked poses
INFO: Step 6: Saving results
INFO: Output manager initialized: benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115137
INFO: Metadata exported to JSON: benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115137/6e4c_20250704_115137_poses_metadata.json
INFO: FAIR metadata saved to benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115137/6e4c_20250704_115137_poses_metadata.json
INFO: Saved 3 poses to benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115137/6e4c_20250704_115137_poses.sdf
INFO: Pipeline completed successfully (alignment_used=True)
INFO: Loaded 18902 molecules from processed_ligands_new.sdf.gz (skipped 0)
INFO: Memory used for loading: 0.4GB
INFO: Loaded 18902 molecules into cache
INFO: Running TEMPL pipeline for 6seo
INFO: Starting pipeline execution for 6seo
INFO: Step 1: Generating protein embedding
INFO: Successfully calculated RMSD for 3 metrics
INFO: Error tracking enabled
INFO: TEMPL pipeline initialized with 0.1GB memory usage
INFO: Shared cache not available, loading individually
INFO: Loading molecules from processed_ligands_new.sdf.gz...
INFO: TEMPL completed for 6e4c in 19.2s
INFO: Generating embedding for /home/ubuntu/mcs/templ_pipeline/data/PDBBind/PDBbind_v2020_other_PL/v2020-other-PL/6seo/6seo_protein.pdb
2025-07-04 11:51:39,325 - templ_pipeline.core.embedding - INFO - Loaded 18902 embeddings from /home/ubuntu/mcs/templ_pipeline/data/embeddings/protein_embeddings_base.npz
INFO: Loaded 18902 embeddings from /home/ubuntu/mcs/templ_pipeline/data/embeddings/protein_embeddings_base.npz
INFO: Using cached embedding for PDB: 6seo
INFO: Retrieved cached embedding with shape (1280,) for chain A
INFO: Step 2: Finding similar templates
INFO: Finding similar templates
2025-07-04 11:51:39,427 - templ_pipeline.core.embedding - INFO - Found 100 neighbors for QUERY.
INFO: Found 100 neighbors for QUERY.
INFO: Found 100 templates
INFO: Step 3: Loading template molecules
INFO: Loading templates from: data/ligands/processed_ligands_new.sdf.gz (with error tolerance)
WARNING: MCS search failed for molecule 0 at threshold 0.40000000000000013: 
INFO: Successfully generated 200 conformers
INFO: DEBUG: mcs_atom_indices type: <class 'dict'>
INFO: DEBUG: mcs_atom_indices content: {'atom_count': 28, 'bond_count': 30, 'similarity_score': 0.9, 'query_atoms': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27], 'template_atoms': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27], 'smarts': 'CC1CCCN(-S(=O)(=O)-c2:c:c(-NC(=O)-CN3C(=O)-CNC3=O):c:c:c:2-Br)-C1', 'organometallic_handling': {'target_had_metals': False, 'template_had_metals': False, 'target_substitutions': ['No organometallic atoms detected'], 'template_substitutions': ['No organometallic atoms detected']}, 'selected_template_index': 78}
INFO: MCS info captured for template selection
INFO: Generated 200/200 conformers
INFO: Scoring and selecting best poses (aligned_poses=True)
INFO: Scoring 200 conformers using 2 workers
INFO: Generated 3 best poses, 200 total ranked poses
INFO: Step 6: Saving results
INFO: Output manager initialized: benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115140
INFO: Loaded 18902 molecules from processed_ligands_new.sdf.gz (skipped 0)
INFO: Memory used for loading: 0.4GB
INFO: Loaded 18902 molecules into cache
INFO: Running TEMPL pipeline for 6dyz
INFO: Starting pipeline execution for 6dyz
INFO: Step 1: Generating protein embedding
INFO: Metadata exported to JSON: benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115140/6moa_20250704_115140_poses_metadata.json
INFO: FAIR metadata saved to benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115140/6moa_20250704_115140_poses_metadata.json
INFO: Saved 3 poses to benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115140/6moa_20250704_115140_poses.sdf
INFO: Pipeline completed successfully (alignment_used=True)
INFO: Successfully calculated RMSD for 3 metrics
INFO: TEMPL completed for 6moa in 26.9s
INFO: Generating embedding for /home/ubuntu/mcs/templ_pipeline/data/PDBBind/PDBbind_v2020_refined/refined-set/6dyz/6dyz_protein.pdb
INFO: Generated 3 best poses, 200 total ranked poses
INFO: Step 6: Saving results
INFO: Output manager initialized: benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115141
2025-07-04 11:51:42,259 - templ_pipeline.core.embedding - INFO - Loaded 18902 embeddings from /home/ubuntu/mcs/templ_pipeline/data/embeddings/protein_embeddings_base.npz
INFO: Loaded 18902 embeddings from /home/ubuntu/mcs/templ_pipeline/data/embeddings/protein_embeddings_base.npz
INFO: Using cached embedding for PDB: 6dyz
INFO: Retrieved cached embedding with shape (1280,) for chain A
INFO: Step 2: Finding similar templates
INFO: Finding similar templates
2025-07-04 11:51:42,369 - templ_pipeline.core.embedding - INFO - Found 100 neighbors for QUERY.
INFO: Found 100 neighbors for QUERY.
INFO: Found 100 templates
INFO: Step 3: Loading template molecules
INFO: Loading templates from: data/ligands/processed_ligands_new.sdf.gz (with error tolerance)
INFO: Metadata exported to JSON: benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115141/6jb4_20250704_115141_poses_metadata.json
INFO: FAIR metadata saved to benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115141/6jb4_20250704_115141_poses_metadata.json
INFO: Saved 3 poses to benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115141/6jb4_20250704_115141_poses.sdf
INFO: Pipeline completed successfully (alignment_used=True)
INFO: Successfully calculated RMSD for 3 metrics
INFO: TEMPL completed for 6jb4 in 23.0s
INFO: Template loading complete: 100 templates loaded from 18902 processed
INFO: Loaded 100 template molecules using standardized loader
INFO: Step 4: Preparing query molecule
INFO: Creating molecule from SMILES: CC(=O)N[C@H](C(=O)N1CCC[C@H]1C(=O)N[C@@H](CC(C)C)C(=O)N[C@@H](CCCNC(N)=[NH2+])C(=O)N[C@@H](C)C(=O)N[C@@H](CCCNC(N)=[NH2+])C(=O)N[C@@H](CC(N)=O)C(=O)N[C@@H](CC(C)C)C(=O)N1CCC[C@H]1C(=O)N1CCC[C@H]1C(=O)N[C@@H](CO)C(=O)N[C@@H](Cc1ccccc1)C(=O)N[C@@H](Cc1ccccc1)C(=O)N[C@H](C(=O)N[C@@H](CCC(=O)[O-])C(=O)N1CCC[C@H]1C(N)=O)[C@@H](C)O)C(C)C
INFO: Generated 3 best poses, 200 total ranked poses
INFO: Step 6: Saving results
INFO: Output manager initialized: benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115144
INFO: Metadata exported to JSON: benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115144/6oxq_20250704_115144_poses_metadata.json
INFO: FAIR metadata saved to benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115144/6oxq_20250704_115144_poses_metadata.json
INFO: Saved 3 poses to benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115144/6oxq_20250704_115144_poses.sdf
INFO: Pipeline completed successfully (alignment_used=True)
INFO: Template loading complete: 100 templates loaded from 18902 processed
INFO: Loaded 100 template molecules using standardized loader
INFO: Step 4: Preparing query molecule
INFO: Creating molecule from SMILES: C#CCSC[C@H]1C[N@@H+](Cc2c[nH]c3c(N)ncnc23)C[C@@H]1O
INFO: Query molecule prepared (standardized): 22 atoms, 24 bonds
INFO: Step 5: Generating poses (alignment=enabled)
INFO: Successfully calculated RMSD for 3 metrics
INFO: Generating poses with 100 templates, 200 conformers, 2 workers
INFO: Finding MCS and generating conformers
INFO: Generating conformers for unnamed_query using 100 templates: template_0, template_1, template_2...
INFO: Query molecule: 22 atoms, 24 bonds
INFO: Selected template template_71 with MCS SMARTS: C#CCSCC1CN(-Cc2:c:n:c3:c(-N):n:c:n:c:2:3)-CC1O
INFO: Query molecule prepared (standardized): 134 atoms, 139 bonds
INFO: Step 5: Generating poses (alignment=enabled)
INFO: Molecule complexity: {'num_atoms': 134, 'num_heavy_atoms': 134, 'num_bonds': 139, 'num_rings': 6, 'molecular_weight': 1882.0333784440888, 'has_organometallics': False, 'estimated_peptide_residues': 18}
ERROR: Pipeline failed: query: ❌ Target is a large peptide (18 residues > 8 threshold) - cannot be processed. This pipeline is designed for drug-like small molecules only. Large peptides require specialized conformational sampling methods.
INFO: TEMPL completed for 6oxq in 52.4s
INFO: SKIP 6seo: query: ❌ Target is a large peptide (18 residues > 8 threshold) - cannot be processed. This pipeline is designed for drug-like small molecules only. Large peptides require specialized conformational sampling methods.
INFO: Molecule 6seo skipped: query: ❌ Target is a large peptide (18 residues > 8 threshold) - cannot be processed. This pipeline is designed for drug-like small molecules only. Large peptides require specialized conformational sampling methods.
INFO: Successfully generated 200 conformers
INFO: DEBUG: mcs_atom_indices type: <class 'dict'>
INFO: DEBUG: mcs_atom_indices content: {'atom_count': 22, 'bond_count': 24, 'similarity_score': 0.9, 'query_atoms': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21], 'template_atoms': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21], 'smarts': 'C#CCSCC1CN(-Cc2:c:n:c3:c(-N):n:c:n:c:2:3)-CC1O', 'organometallic_handling': {'target_had_metals': False, 'template_had_metals': False, 'target_substitutions': ['No organometallic atoms detected'], 'template_substitutions': ['No organometallic atoms detected']}, 'selected_template_index': 71}
INFO: MCS info captured for template selection
INFO: Generated 200/200 conformers
INFO: Scoring and selecting best poses (aligned_poses=True)
INFO: Scoring 200 conformers using 2 workers
WARNING: MCS search failed for molecule 39 at threshold 0.40000000000000013: 
INFO: Generated 3 best poses, 200 total ranked poses
INFO: Step 6: Saving results
INFO: Output manager initialized: benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115151
INFO: Successfully generated 200 conformers
INFO: DEBUG: mcs_atom_indices type: <class 'dict'>
INFO: DEBUG: mcs_atom_indices content: {'atom_count': 46, 'bond_count': 48, 'similarity_score': 0.9, 'query_atoms': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45], 'template_atoms': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45], 'smarts': 'CN(-NC(=O)-CCC(-NC(=O)-OCc1:c:c:c:c:c:1)-C(=O)-NC(-CCCCN)-C(-O)-C(=O)-NCc1:c:c:c:c:c:1)-c1:c:c:c:c:c:1', 'organometallic_handling': {'target_had_metals': False, 'template_had_metals': False, 'target_substitutions': ['No organometallic atoms detected'], 'template_substitutions': ['No organometallic atoms detected']}, 'selected_template_index': 30}
INFO: MCS info captured for template selection
INFO: Generated 200/200 conformers
INFO: Scoring and selecting best poses (aligned_poses=True)
INFO: Scoring 200 conformers using 2 workers
INFO: Metadata exported to JSON: benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115151/6s55_20250704_115151_poses_metadata.json
INFO: FAIR metadata saved to benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115151/6s55_20250704_115151_poses_metadata.json
INFO: Saved 3 poses to benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115151/6s55_20250704_115151_poses.sdf
INFO: Pipeline completed successfully (alignment_used=True)
INFO: Successfully calculated RMSD for 3 metrics
INFO: TEMPL completed for 6s55 in 25.8s
INFO: Generated 3 best poses, 200 total ranked poses
INFO: Step 6: Saving results
INFO: Output manager initialized: benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115156
INFO: Metadata exported to JSON: benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115156/6dyz_20250704_115156_poses_metadata.json
INFO: FAIR metadata saved to benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115156/6dyz_20250704_115156_poses_metadata.json
INFO: Saved 3 poses to benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115156/6dyz_20250704_115156_poses.sdf
INFO: Pipeline completed successfully (alignment_used=True)
INFO: Successfully calculated RMSD for 3 metrics
INFO: TEMPL completed for 6dyz in 18.2s
INFO: Selected template template_40 with MCS SMARTS: [#6]-CC(-NC(-C(-NC(-CC)-C(=O)-NC(-CCC)-C(=O)-NCc1:c:c:c(-C(-N)=N):c:c:1)=O)-CCCNC(-N)=N)=O
INFO: Generated 3 best poses, 200 total ranked poses
INFO: Step 6: Saving results
INFO: Output manager initialized: benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115212
INFO: Metadata exported to JSON: benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115212/6i9a_20250704_115212_poses_metadata.json
INFO: FAIR metadata saved to benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115212/6i9a_20250704_115212_poses_metadata.json
INFO: Saved 3 poses to benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115212/6i9a_20250704_115212_poses.sdf
INFO: Pipeline completed successfully (alignment_used=True)
INFO: Successfully calculated RMSD for 3 metrics
INFO: TEMPL completed for 6i9a in 54.6s
WARNING: MCS search failed for molecule 91 at threshold 0.40000000000000013: 
INFO: Successfully generated 200 conformers
INFO: DEBUG: mcs_atom_indices type: <class 'dict'>
INFO: DEBUG: mcs_atom_indices content: {'atom_count': 39, 'bond_count': 39, 'similarity_score': 0.8, 'query_atoms': [6, 7, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57], 'template_atoms': [20, 19, 0, 1, 4, 31, 32, 33, 34, 35, 36, 37, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18], 'smarts': '[#6]-CC(-NC(-C(-NC(-CC)-C(=O)-NC(-CCC)-C(=O)-NCc1:c:c:c(-C(-N)=N):c:c:1)=O)-CCCNC(-N)=N)=O', 'organometallic_handling': {'target_had_metals': False, 'template_had_metals': False, 'target_substitutions': ['No organometallic atoms detected'], 'template_substitutions': ['No organometallic atoms detected']}, 'selected_template_index': 40}
INFO: MCS info captured for template selection
INFO: Generated 200/200 conformers
INFO: Scoring and selecting best poses (aligned_poses=True)
INFO: Scoring 200 conformers using 2 workers
INFO: Selected template template_31 with MCS SMARTS: CC(=O)-NC(-C(=O)-NC(-C)-C(=O)-NC(-C)-C(=O)-NC(-CCCCNC)-C(=O)-NC(-CO)-C=O)-C-[#6]
INFO: Generated 3 best poses, 200 total ranked poses
INFO: Step 6: Saving results
INFO: Output manager initialized: benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115339
INFO: Metadata exported to JSON: benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115339/6hzb_20250704_115339_poses_metadata.json
INFO: FAIR metadata saved to benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115339/6hzb_20250704_115339_poses_metadata.json
INFO: Saved 3 poses to benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115339/6hzb_20250704_115339_poses.sdf
INFO: Pipeline completed successfully (alignment_used=True)
INFO: Successfully calculated RMSD for 3 metrics
INFO: TEMPL completed for 6hzb in 167.4s
WARNING: MCS search failed for molecule 98 at threshold 0.40000000000000013: 
INFO: Successfully generated 200 conformers
INFO: DEBUG: mcs_atom_indices type: <class 'dict'>
INFO: DEBUG: mcs_atom_indices content: {'atom_count': 35, 'bond_count': 34, 'similarity_score': 0.6000000000000001, 'query_atoms': [15, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 57, 58, 59, 60, 61, 62, 63, 64, 66, 67], 'template_atoms': [0, 1, 2, 3, 4, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 41, 42, 43, 44, 45, 46, 47, 49, 5, 6], 'smarts': 'CC(=O)-NC(-C(=O)-NC(-C)-C(=O)-NC(-C)-C(=O)-NC(-CCCCNC)-C(=O)-NC(-CO)-C=O)-C-[#6]', 'organometallic_handling': {'target_had_metals': False, 'template_had_metals': False, 'target_substitutions': ['No organometallic atoms detected'], 'template_substitutions': ['No organometallic atoms detected']}, 'selected_template_index': 31}
INFO: MCS info captured for template selection
INFO: Generated 200/200 conformers
INFO: Scoring and selecting best poses (aligned_poses=True)
INFO: Scoring 200 conformers using 2 workers
WARNING: MCS search failed for molecule 99 at threshold 0.40000000000000013: 
INFO: Selected template template_52 with MCS SMARTS: CCC(-NC(=O)-CNC(=O)-C(-CCCNC(-N)=N)-NC(=O)-CN)-C(=O)-NC(-C)-C(=O)-NC(-CCC)-C=O
WARNING: Constrained embedding failed to produce conformers for template template_52
INFO: MCS match analysis: 37 atoms matched (48.1% of query, 90.2% of template)
INFO: DEBUG: mcs_atom_indices type (failed case): <class 'dict'>
INFO: DEBUG: mcs_atom_indices content (failed case): {'atom_count': 37, 'bond_count': 36, 'similarity_score': 0.40000000000000013, 'query_atoms': [5, 6, 7, 8, 9, 10, 11, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 46, 47, 48, 49, 50, 55, 56, 57, 58, 59, 60, 61, 64, 65], 'template_atoms': [22, 21, 20, 19, 17, 18, 16, 15, 13, 14, 7, 6, 5, 4, 3, 1, 0, 2, 8, 9, 10, 11, 12, 25, 26, 27, 28, 29, 31, 32, 33, 37, 36, 35, 34, 38, 39], 'smarts': 'CCC(-NC(=O)-CNC(=O)-C(-CCCNC(-N)=N)-NC(=O)-CN)-C(=O)-NC(-C)-C(=O)-NC(-CCC)-C=O', 'organometallic_handling': {'target_had_metals': False, 'template_had_metals': False, 'target_substitutions': ['No organometallic atoms detected'], 'template_substitutions': ['No organometallic atoms detected']}, 'selected_template_index': 52}
INFO: MCS-based conformer generation failed - implementing fallback strategies
INFO: Strategy 2: Generating unconstrained conformers
WARNING: Unconstrained fallback failed: Resource temporarily unavailable
WARNING: Strategy 3: Attempting minimal conformer generation as last resort
WARNING: Minimal fallback generated 20 conformers (reduced from 200)
INFO: MCS info captured for template selection
INFO: Generated 20/200 conformers
WARNING: Used minimal fallback strategy for conformer generation
INFO: Scoring and selecting best poses (aligned_poses=True)
INFO: Scoring 20 conformers using 2 workers
WARNING: Parallel processing failed: can't start new thread, falling back to sequential
INFO: Generated 3 best poses, 20 total ranked poses
INFO: Step 6: Saving results
INFO: Output manager initialized: benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115437
ERROR: Error generating FAIR metadata: /home/ubuntu/mcs/templ_pipeline/.templ/lib/python3.12/site-packages/nvidia/cublas/lib/libcublas.so.12: failed to map segment from shared object
INFO: Saved 3 poses to benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115437/6hld_20250704_115437_poses.sdf
INFO: Pipeline completed successfully (alignment_used=True)
INFO: Successfully calculated RMSD for 3 metrics
INFO: TEMPL completed for 6hld in 199.8s
INFO: Generated 3 best poses, 200 total ranked poses
INFO: Step 6: Saving results
INFO: Output manager initialized: benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115459
INFO: Metadata exported to JSON: benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115459/6d08_20250704_115459_poses_metadata.json
INFO: FAIR metadata saved to benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115459/6d08_20250704_115459_poses_metadata.json
INFO: Saved 3 poses to benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/poses_20250704_115459/6d08_20250704_115459_poses.sdf
INFO: Pipeline completed successfully (alignment_used=True)
INFO: Successfully calculated RMSD for 3 metrics
INFO: TEMPL completed for 6d08 in 247.5s

============================================================
BENCHMARK ERROR SUMMARY
============================================================
Total targets attempted: 20
Successful targets: 19
Failed targets: 1
Success rate: 95.0%
Unique missing PDBs: 1
Total error instances: 1

Error Categories:
  target_processing_failed: 1

Missing PDBs by Component:
  pipeline: 1 PDBs
    6seo
============================================================

Recovery plan saved to: benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/error_tracking/recovery_plan.json
Recovery Plan Summary:
  alternative_sources: 1 PDBs

Detailed error report: benchmark_workspace_time-split_20250704_115049/raw_results/timesplit/error_tracking/timesplit_combined_error_report.json
INFO: Generating summary for timesplit benchmark
INFO: Saved csv summary to benchmark_workspace_time-split_20250704_115049/summaries/timesplit_benchmark_summary_20250704_115500.csv
INFO: Saved json summary to benchmark_workspace_time-split_20250704_115049/summaries/timesplit_benchmark_summary_20250704_115500.json
INFO: Saved markdown summary to benchmark_workspace_time-split_20250704_115049/summaries/timesplit_benchmark_summary_20250704_115500.md
INFO: Generated summary files:
INFO:   CSV: benchmark_workspace_time-split_20250704_115049/summaries/timesplit_benchmark_summary_20250704_115500.csv
INFO:   JSON: benchmark_workspace_time-split_20250704_115049/summaries/timesplit_benchmark_summary_20250704_115500.json
INFO:   MARKDOWN: benchmark_workspace_time-split_20250704_115049/summaries/timesplit_benchmark_summary_20250704_115500.md
INFO: Timesplit benchmark completed successfully!
INFO: Workspace directory: benchmark_workspace_time-split_20250704_115049
